; Arquivo de configuração do Supervisor para KeywordAI
; Coloque este arquivo em /etc/supervisor/conf.d/ no servidor de produção
; Execute: sudo supervisorctl reread && sudo supervisorctl update
; Para verificar status: sudo supervisorctl status all

[group:keywordai]
programs=keywordai-critical,keywordai-notifications,keywordai-default,keywordai-bulk

; Fila de prioridade máxima (critical) - Para adição de palavras-chave positivas e negativas
[program:keywordai-critical]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/keywordai/artisan queue:work --queue=critical --sleep=3 --tries=3 --max-time=3600
autostart=true
autorestart=true
user=www-data
numprocs=2
redirect_stderr=true
stdout_logfile=/var/log/supervisor/keywordai-critical.log
stopwaitsecs=60

; Fila de alta prioridade (notifications) - Para notificações
[program:keywordai-notifications]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/keywordai/artisan queue:work --queue=notifications --sleep=3 --tries=3 --max-time=3600
autostart=true
autorestart=true
user=www-data
numprocs=1
redirect_stderr=true
stdout_logfile=/var/log/supervisor/keywordai-notifications.log
stopwaitsecs=60

; Fila de prioridade média (default) - Para sincronizações regulares e atualizações de estatísticas
[program:keywordai-default]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/keywordai/artisan queue:work --queue=default --sleep=3 --tries=3 --max-time=3600
autostart=true
autorestart=true
user=www-data
numprocs=2
redirect_stderr=true
stdout_logfile=/var/log/supervisor/keywordai-default.log
stopwaitsecs=60

; Fila de baixa prioridade (bulk) - Para tarefas de fundo longas
[program:keywordai-bulk]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/keywordai/artisan queue:work --queue=bulk --sleep=10 --tries=1 --max-time=7200
autostart=true
autorestart=true
user=www-data
numprocs=1
redirect_stderr=true
stdout_logfile=/var/log/supervisor/keywordai-bulk.log
stopwaitsecs=120
